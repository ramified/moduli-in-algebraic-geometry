\section{Moduli of elliptic curve}
The elliptic curve theory is especially rich compared to the other curves. That's why we'd like to put it a special section.
\subsection{Definition and basic properties of elliptic curve}
\begin{defn}[Relative elliptic curve]
Let $S \in \Ob(\Schk)$. An $S$-group scheme $(E,m)$ is called an elliptic curve over $S$ if the structure map $\pi: E\longrightarrow S$ is proper, smooth of relative dimension $1$, and has connected fibers. Two elliptic curves are considered as the same if they are isomorphic as the $S$-group scheme.
\end{defn}
This data is equivalent to what we described for $\mathcal{M}_{1,1}(S)$ in Definition \ref{def:moduliofcurves}, and also equivalent to the definition in \cite[\href{https://stacks.math.columbia.edu/tag/072J}{Tag 072J}]{stacks-project}. 

Recall the Cohomology and Base Change Theorem in \cite[28.1.6]{FOAG}. Here we just give a simplified version:
\begin{theorem}[Cohomology and Base Change Theorem, simplified version]\label{thm:cohbc} $\hspace{0cm}$

	\begin{minipage}[t]{.6\textwidth}
	\vspace{-1cm}
Suppose		
\begin{itemize}
\item $S$ is locally Noetherian;
\item $\pi: X \longrightarrow S$ is proper;
\item The coherent sheaf $\mathcal{F}$ over $X$ is flat over $S$.
\end{itemize}
	\end{minipage}
\hfill\vline\hfill
	\begin{minipage}[b]{.36\textwidth}
		\centering
% https://q.uiver.app/?q=WzAsNSxbMCwxLCJYX3EiXSxbMSwxLCJYIl0sWzAsMiwiXFxTcGVjXFwsIFxca2FwcGEocSkiXSxbMSwyLCJTIl0sWzIsMCwiXFxtYXRoY2Fse0Z9Il0sWzAsMV0sWzAsMiwiXFxwaV9xIiwyXSxbMiwzLCJcXGlvdGEiXSxbMSwzLCJcXHBpIl0sWzQsMSwiIiwwLHsic3R5bGUiOnsiaGVhZCI6eyJuYW1lIjoibm9uZSJ9fX1dXQ==
\[\begin{tikzcd}
	&[-3mm]&[-5mm] {\mathcal{F}} \\[-6mm]
	{X_q} & X \\
	{\hspace{-0.8cm}\Spec\, \kappa(q)} & S
	\arrow[from=2-1, to=2-2]
	\arrow["{\pi_q}"', from=2-1, to=3-1]
	\arrow["\iota", from=3-1, to=3-2]
	\arrow["\pi", from=2-2, to=3-2]
	\arrow[no head, from=1-3, to=2-2]
\end{tikzcd}\]
	\end{minipage}
then for any $q \in S$ and $p \in \mathbb{Z}$, we have the  natural map
$$\phi^p_q: (\rderiv{p}{\pi_*}  \mathcal{F})|_q \longrightarrow H^p(X_q,\mathcal{F}|_{X_q})$$
which has the following properties:
$$\phi^p_q \text{ is surj } \Longrightarrow \begin{cases}
\hspace{2.6mm}\phi^p_q \text{ is iso }\\
\left(\phi^{p-1}_q \text{ is surj } \Leftrightarrow \rderiv{p}{\pi_*}  \mathcal{F} \text{ is l.f. }\right)
\end{cases}$$
\end{theorem}

We can use Theorem \ref{thm:cohbc} to compute some pushforward of sheaves, and the results are shown here:

\begin{table}[ht]
\[
\begin{array}{|r|c|c|c|c|c|c|c|}
\hline
n                                   & -3                    & -2                    & -1          & 0             & 1           & 2                     & 3                     \\ \hline
\rderiv{1}{\pi_*} \mathcal{O}_E(ne) & \text{rank 3} & \text{rank 2} & \text{l.b.} & \text{l.b.}   & 0           & 0                     & 0                     \\ \hline
\pi_* \mathcal{O}_E(ne)             & 0                     & 0                     & 0           & \mathcal{O}_S & \text{l.b.} & \text{rank 2} & \text{rank 3} \\ \hline
\rderiv{1}{\pi_*} \Omega_{E/S}(ne)  & \text{rank 3} & \text{rank 2} & \text{l.b.} & \mathcal{O}_S & 0           & 0                     & 0                     \\ \hline
\pi_* \Omega_{E/S}(ne)              & 0                     & 0                     & 0           & \text{l.b.}   & \text{l.b.} & \text{rank 2} & \text{rank 3} \\ \hline
\end{array}
\]
    \caption{results of higher pushforward}
    \label{table:higherpushforward}
\end{table}
\begin{eg}[{case of $\rderiv{p}{\pi_*} \mathcal{O}_E$}]
Let $X=E$ be an elliptic curve over $S$, $\mathcal{F}=\mathcal{O}_X$. Obviously $\phi_q^2,\phi_q^{-1}$ are surjective; the map $\phi_q^{0}$ is also surjective\footnote{see the hint in \cite[28.1.H]{FOAG}.}. By using Theorem \ref{thm:cohbc} (see the Figure \ref{fig:cohbc1}) we obtain that $$\rderiv{p}{\pi_*} \mathcal{O}_X= \begin{cases}
0 & p \geqslant 2 \\
\text{line bundle} & p=0,1
\end{cases}$$
\end{eg}
\begin{figure}[ht]
\centering
\begin{tikzpicture}[node distance=5mm and 15mm, 
initial/.style={
color=red,
}]
\node (phiq2) [initial] {$\phi_q^2$ is surj};
\node (phiq1) [below right=of phiq2] {$\phi_q^1$ is surj};
\node (phiq0) [below right=of phiq1, initial] {$\phi_q^0$ is surj};
\node (phiq-1) [below right=of phiq0, initial] {$\phi_q^{-1}$ is surj};
\node (fiber2) [above right=of phiq2] {$\rderiv{2}{\pi_*}\mathcal{F}|_q=0$};
\node (fiber1) [above right=of phiq1] {$\rderiv{1}{\pi_*}\mathcal{F}|_q \cong \kappa(q)$};
\node (fiber0) [above right=of phiq0] {$\pi_*\mathcal{F}|_q\cong \kappa(q)$};
\node (lf2) [right=of phiq2] {$\rderiv{2}{\pi_*}\mathcal{F}$ is l.f.};
\node (lf1) [right=of phiq1] {$\rderiv{1}{\pi_*}\mathcal{F}$ is l.f.};
\node (lf0) [right=of phiq0] {${\pi_*}\mathcal{F}$ is l.f.};
\path ($ (lf2.south west) + (10mm,0) $) edge[commutative diagrams/Rightarrow, 2tail reversed] ($ (phiq1.north west) + (10mm,0) $);
\path ($ (lf1.south west) + (10mm,0) $) edge[commutative diagrams/Rightarrow, 2tail reversed] ($ (phiq0.north west) + (10mm,0) $);
\path ($ (lf0.south west) + (10mm,0) $) edge[commutative diagrams/Rightarrow, 2tail reversed] ($ (phiq-1.north west) + (10mm,0) $);
\path ($ (fiber2.south west) + (10mm,0) $) edge[->,edge label=Nakayama, red] ($ (lf2.north west) + (10mm,0) $);
\draw [->]
(phiq2.east)
-- ($ (phiq2.east) + (12mm,0) $)
|- (fiber2.west);
\draw [->]
($ (phiq2.east) + (12mm,0) $)
|- ($ (lf2.south west)!0.5!(phiq1.north west) + (8mm,0)$);
\draw [->]
(phiq1.east)
-- ($ (phiq1.east) + (12mm,0) $)
|- (fiber1.west);
\draw [->]
($ (phiq1.east) + (12mm,0) $)
|- ($ (lf1.south west)!0.5!(phiq0.north west) + (8mm,0)$);
\draw [->]
(phiq0.east)
-- ($ (phiq0.east) + (12mm,0) $)
|- (fiber0.west);
\draw [->]
($ (phiq0.east) + (12mm,0) $)
|- ($ (lf0.south west)!0.5!(phiq-1.north west) + (8mm,0)$);
\end{tikzpicture}
\caption{the process; \textcolor{red}{red} color is the initial condition}
\label{fig:cohbc1}
\end{figure}
\begin{lemma}
$\pi_*\mathcal{O}_X \cong \mathcal{O}_S$.
\end{lemma}
\begin{proof}
The morphism $\pi: X \longrightarrow S$ induces the map of sheaves
$$\pi^{\#}: \mathcal{O}_S \longrightarrow \pi_*\mathcal{O}_X$$
which corresponds a section of $\pi_*\mathcal{O}_X$. Since $\pi_*\mathcal{O}_X$ is a line bundle, this section defines a Cartier divisor $D$ of $S$, i.e. $\pi_*\mathcal{O}_X \cong \mathcal{O}_S(D)$. From the isomorphism 
$$\pi^{\#}|_q : \kappa(q) \longrightarrow \pi_*\mathcal{O}_X \times_{\mathcal{O}_S} \kappa(q) \textcolor{ashgrey}{ \stackrel{\phi_q^0}{\longrightarrow}H^0(X_q,\mathcal{O}_{X_q}) \cong \kappa(q) }$$
we get $D=0$, thus $\pi_*\mathcal{O}_X \cong \mathcal{O}_S$.
\end{proof}

\begin{remark}
The other cases are similarly solved except $\mathcal{F}=\Omega_{E/S}$. Actually, if we admit the Grothendieck-Serre duality
$$\rderiv{p}{\pi_*}\Omega_{E/S} \cong (\rderiv{1-p}{\pi_*} \mathcal{O}_E)^{\vee}$$
this would be easily solved. You can see the discussion \href{https://math.stackexchange.com/questions/1938206/local-freeness-of-the-hodge-bundle}{here} for Exercise \cite[28.1.N]{FOAG}, and \cite[2.1.2]{hida2011geometric} for the ``proof" of Grothendieck-Serre duality. For me the question in stackexchange is still unsolved, and for solving Exercise \cite[28.1.N]{FOAG} one need to assume the base scheme is reduced to use the Grauert’s Theorem in \cite[28.1.5]{FOAG}.(The Figure \ref{fig:cohbc2} shows where we use the Grauert’s Theorem.)
\end{remark}
\begin{table}[ht]
\begin{tabular}{@{}lll@{}}
\toprule
\multicolumn{1}{c}{Method} & \multicolumn{1}{c}{Result} & \multicolumn{1}{c}{Requirement} \\ \midrule
Grothendieck-Serre duality & $\rderiv{1}{\pi_*}\mathcal{F} \cong \mathcal{O}_E$ & haven't checked \\
Grauert's theorem & $\rderiv{1}{\pi_*}\mathcal{F}$ is l.f. & $S$ is reduced \\
$\Omega_{E/S} \cong \mathcal{O}_E$ locally & $\rderiv{1}{\pi_*}\mathcal{F}$ is l.f. & $E/S$ is group scheme \\ \bottomrule
\end{tabular}
\caption{}
\end{table}
\begin{figure}[ht]
\centering
\begin{tikzpicture}[node distance=5mm and 15mm, 
initial/.style={
color=red,
}]
\node (phiq2) [initial] {$\phi_q^2$ is surj};
\node (phiq1) [below right=of phiq2] {$\phi_q^1$ is surj};
\node (phiq0) [below right=of phiq1] {$\phi_q^0$ is surj};
\node (phiq-1) [below right=of phiq0, initial] {$\phi_q^{-1}$ is surj};
\node (fiber2) [above right=of phiq2] {$\rderiv{2}{\pi_*}\mathcal{F}|_q=0$};
\node (fiber1) [above right=of phiq1] {$\rderiv{1}{\pi_*}\mathcal{F}|_q \cong \kappa(q)$};
\node (fiber0) [above right=of phiq0] {$\pi_*\mathcal{F}|_q\cong \kappa(q)$};
\node (lf2) [right=of phiq2] {$\rderiv{2}{\pi_*}\mathcal{F}$ is l.f.};
\node (lf1) [right=of phiq1] {$\rderiv{1}{\pi_*}\mathcal{F}$ is l.f.};
\node (lf0) [right=of phiq0] {${\pi_*}\mathcal{F}$ is l.f.};
\path ($ (lf2.south west) + (10mm,0) $) edge[commutative diagrams/Rightarrow, 2tail reversed] ($ (phiq1.north west) + (10mm,0) $);
\path ($ (lf1.south west) + (10mm,0) $) edge[commutative diagrams/Rightarrow, 2tail reversed] ($ (phiq0.north west) + (10mm,0) $);
\path ($ (lf0.south west) + (10mm,0) $) edge[commutative diagrams/Rightarrow, 2tail reversed] ($ (phiq-1.north west) + (10mm,0) $);
\path ($ (fiber2.south west) + (10mm,0) $) edge[->,edge label=Nakayama, red] ($ (lf2.north west) + (10mm,0) $);
\path ($ (fiber1.south west) + (10mm,0) $) edge[->,edge label=Grauert, blue] ($ (lf1.north west) + (10mm,0) $);
\draw [->]
(phiq2.east)
-- ($ (phiq2.east) + (12mm,0) $)
|- (fiber2.west);
\draw [->]
($ (phiq2.east) + (12mm,0) $)
|- ($ (lf2.south west)!0.5!(phiq1.north west) + (8mm,0)$);
\draw [->]
(phiq1.east)
-- ($ (phiq1.east) + (12mm,0) $)
|- (fiber1.west);
\draw [->]
($ (phiq1.east) + (12mm,0) $)
|- ($ (lf1.south west)!0.5!(phiq0.north west) + (8mm,0)$);
\draw [->]
(phiq0.east)
-- ($ (phiq0.east) + (12mm,0) $)
|- (fiber0.west);
\draw [->]
($ (phiq0.east) + (12mm,0) $)
|- ($ (lf0.south west)!0.5!(phiq-1.north west) + (8mm,0)$);
\end{tikzpicture}
\caption{$\mathcal{F}=\Omega_{E/S}$; \textcolor{red}{red} color is the initial condition}
\label{fig:cohbc2}
\end{figure}
\begin{remark}
In the case that $X=E$ is an elliptic curve over $S$, we know more about the Hodge bundle $\pi_*\Omega_{E/S}$ than just a line bundle:
\begin{itemize}
\item $(\pi_*\Omega_{E/S})^{E}=\pi_*\Omega_{E/S}$ since any global differential on an Abelian variety is invarient; % Comes from https://mathoverflow.net/questions/334428/definition-of-an-invariant-differential-of-an-elliptic-curve
\item By \cite[Proposition 3.15]{saito2014fermat}, the line bundle $\omega_{E/S}:=e^*\Omega_{E/S}$ is isomorphic to the Hodge bundle $\pi_*\Omega_{E/S}$.
By the conormal exact sequence, $\omega_{E/S}$ is also isomorphic to  $\mathcal{I}/\mathcal{I}^2:=e^* \mathcal{I}$ where $\mathcal{I}:= \mathcal{O}_E(-e)$ corresponds to the Cartier divisor cut by $e$. So
$$\pi_*\Omega_{E/S} \quad\cong\quad \omega_{E/S}:=e^*\Omega_{E/S} \quad\cong\quad \mathcal{I}/\mathcal{I}^2:=e^* \mathcal{I}.$$
As a corollary, we get
$$\Omega_{E/S} \stackrel{\text{gp sch}}{\cong} \pi^* e^* \Omega_{E/S} = \pi^* \omega_{E/S} \cong \pi^* \pi_* \Omega_{E/S}.$$
and
\begin{equation}\label{eq:pullbackofe}
\begin{aligned}
e^* \big(\mathcal{O}_E(ne)\big) &\cong e^* \big(\mathcal{I}^{\otimes (-n)}\big) \cong (e^* \mathcal{I})^{\otimes (-n)} \cong \omega_{E/S}^{\otimes (-n)}\\
e^*\big(\Omega_{E/S}(ne)\big) &\cong e^*\Omega_{E/S} \otimes e^* \big(\mathcal{O}_E(ne)\big) \cong \omega_{E/S}^{\otimes (-n+1)}
\end{aligned}
\end{equation}
\end{itemize}
\end{remark}
\subsection{Differential}
We know that $\mathcal{M}_{1,1}$ is not representable, so we have to introduce extra structures to rigidify elliptic curves. The first possible extra structure is the differential.
\begin{defn}[{Weierstrass moduli $\widetilde{\mathcal{M}}\!\left[\textstyle \frac{1}{6}\right]$}]
For a base scheme $S \in \Ob(\Sch_{\mathbb{Z}\left[\frac{1}{6} \right]})$, we define a moduli problem
$$\mathcal{A}_S:=\left\{(E,\omega)  \;\middle|\; \begin{aligned}
&\\[-5mm]
& E: \text{ elliptic curve over } S \\[-1mm]
& \omega \in \Gamma(E,\Omega_{E/S}) \text{ global generator }
\end{aligned}
 \right\}$$
 
   $(E,\omega) \sim_S (E',\omega')$ if there exists an isomorphism of elliptic curves $\phi:E \longrightarrow E'$ over $S$ such that $\omega=\phi^* (\omega')$, where
   \footnote{See \cite[21.2.27]{FOAG} and \cite[18.2.E]{FOAG} for the construction of $\phi^*$.}
   $$\phi^*: \Gamma(E',\Omega_{E'/S}) \longrightarrow\Gamma(E',\phi_*\Omega_{E/S})\cong \Gamma(E,\Omega_{E/S})$$
   is got by pulling back $1$-forms from $E'$ to $E$.
   
   For a map $f:T \longrightarrow S$, the pullback $f^*$ is defined by
      $$f^*:\mathcal{A}_S \longrightarrow \mathcal{A}_T \qquad (E,\omega) \longmapsto \big(f^*E,f^*  \omega\big)$$
      
      By doing so we define the moduli functor 
      $$\widetilde{\mathcal{M}}\!\left[\textstyle \frac{1}{6}\right]: \Sch_{\mathbb{Z}\left[\frac{1}{6} \right]} \longrightarrow \Set \qquad S \longmapsto \mathcal{A}_S/\sim_S$$
\end{defn}
\begin{theorem}[{Originally in \cite[Prop 2.5]{deligne1975courbes}}]
The moduli functor $\widetilde{\mathcal{M}}\!\left[\textstyle \frac{1}{6}\right]$ is represented by $\Spec \mathbb{Z}\!\left[\textstyle \frac{1}{6}\right] \left[a,b, \Delta^{-1} \right]$ where $\Delta=-16(4a^3+27b^2)$. Denote $R=\mathbb{Z}\!\left[\textstyle \frac{1}{6}\right] \left[a,b, \Delta^{-1} \right]$, the universal family is $(E_R,\omega_R) \in \widetilde{\mathcal{M}}\!\left[\textstyle \frac{1}{6}\right](R)$, where
\begin{equation*}
\begin{aligned}
  E_R=\;& \Proj R[x,y,z]/\left( y^2z-(x^3+axz^2+bz^3) \right)  \\ 
  \omega_R=\;&  \frac{x\dd z-z\dd x}{2yz}=\frac{y\dd z-z\dd y }{3x^2+az^2} =\frac{x\dd y-y\dd x}{y^2-2axz-3bz^2} \quad\text{ whenever it's defined.}\\ 
\end{aligned}
\end{equation*}
\end{theorem}
\begin{proof}
Fix a scheme $S \in \Ob(\Sch_{\mathbb{Z}\left[\frac{1}{6} \right]})$, we need to construct an isomorphism
$$\Psi: \widetilde{\mathcal{M}}\!\left[\textstyle \frac{1}{6}\right] (S) \stackrel{\sim}{\longrightarrow} \left\{ a,b\in \mathcal{O}_S(S) \middle| \Delta \text{ is invertible}
\right\}$$
Let $(E,\omega) \in \widetilde{\mathcal{M}}\!\left[\textstyle \frac{1}{6}\right] (S)$ in the following steps.

\vspace{0.3cm}\noindent\textbf{\underline{Step1}. } We give an description of $\pi_* \mathcal{O}_E(ne)$ by the following lemma:
\begin{lemma}\label{lem:filstration}
We have a canonical filstration for $\pi_* \mathcal{O}_E(ne)$:
$$
0 \stackrel{\mathcal{O}_S}{\longsubset} \pi_*\mathcal{O}_E = \mathcal{O}_E(e) \stackrel{\omega_{E/S}^{\otimes (-2)}}{\longsubset} \pi_*\mathcal{O}_E(2e) \stackrel{\omega_{E/S}^{\otimes (-3)}}{\longsubset} \pi_*\mathcal{O}_E(3e) \longsubset \cdots
$$
\end{lemma}
\begin{proof}[{Proof of Lemma \ref{lem:filstration}}]
We begin with the short exact sequence
$$0 \longrightarrow \mathcal{O}_E(-e) \longrightarrow \mathcal{O}_E \longrightarrow e_* \mathcal{O}_S \longrightarrow 0$$
apply the functor $- \otimes_{\mathcal{O}_E}\mathcal{O}_E(ne)$, since
$$e_* \mathcal{O}_S\otimes_{\mathcal{O}_E}\mathcal{O}_E(ne) \cong e_*\Big(\mathcal{O}_S\otimes_{\mathcal{O}_S}e^*\big(\mathcal{O}_E(ne)\big) \Big) \cong e_*e^*\big(\mathcal{O}_E(ne)\big) \stackrel{(\ref{eq:pullbackofe})}{\cong}e_*\omega_{E/S}^{\otimes (-n)}$$
we get short exact sequence 
$$0 \longrightarrow \mathcal{O}_E\big((n-1)e\big) \longrightarrow \mathcal{O}_E(ne) \longrightarrow e_*\omega_{E/S}^{\otimes (-n)} \longrightarrow 0$$
apply $\pi_*$, we get long exact sequence
$$0 \longrightarrow \pi_*\mathcal{O}_E\big((n-1)e\big) \longrightarrow \pi_*\mathcal{O}_E(ne) \longrightarrow \omega_{E/S}^{\otimes (-n)} \longrightarrow \rderiv{1}{\pi_*} \mathcal{O}_E\big((n-1)e\big) \longrightarrow \rderiv{1}{\pi_*} \mathcal{O}_E(ne)$$
thus we get the result.
\end{proof}

\vspace{0.3cm}\noindent\textbf{\underline{Step2}. }From the filstration we construct the Weierstrass equation locally.

For any point $p \in S$, choose small enough open affine neighbourhood $U \subseteq S$ such that all the sheaf considered here are all free when restricted to $U$. Then from Lemma \ref{lem:filstration} we get split exact sequences of $\mathcal{O}_S(U)$-modules \textcolor{ashgrey}{($k \geqslant 3$)}

% https://q.uiver.app/?q=WzAsMTAsWzEsMCwiXFxHYW1tYShVLFxcbWF0aGNhbHtPfV9TKSJdLFsyLDAsIlxcR2FtbWFcXGJpZyhVLFxccGlfKlxcbWF0aGNhbHtPfV9FKDJlKVxcYmlnKSJdLFszLDAsIlxcR2FtbWEoVSxcXG9tZWdhX3tFL1N9XntcXG90aW1lcyAoLTIpfSkiXSxbMCwwLCIwIl0sWzQsMCwiSF4xKFUsXFxtYXRoY2Fse099X1MpIl0sWzIsMSwiXFxHYW1tYVxcYmlnKFUsXFxwaV8qXFxtYXRoY2Fse099X0Uoa2UpXFxiaWcpIl0sWzEsMSwiXFxHYW1tYVxcQmlnKFUsXFxwaV8qXFxtYXRoY2Fse099X0VcXGJpZygoay0xKWVcXGJpZylcXEJpZykiXSxbMCwxLCIwIl0sWzMsMSwiXFxHYW1tYShVLFxcb21lZ2Ffe0UvU31ee1xcb3RpbWVzICgtayl9KSJdLFs0LDEsIkheMVxcQmlnKFUsXFxwaV8qXFxtYXRoY2Fse099X0VcXGJpZygoay0xKWVcXGJpZylcXEJpZykiXSxbMywwXSxbMCwxXSxbMSwyLCJwXzIiXSxbMiw0LCIwIl0sWzIsMSwibF8yIiwwLHsiY3VydmUiOi01LCJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJkYXNoZWQifX19XSxbNyw2XSxbNiw1XSxbNSw4LCJwX2siXSxbOCw5LCIwIl0sWzgsNSwibF9rIiwwLHsiY3VydmUiOi01LCJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJkYXNoZWQifX19XV0=
\[\begin{tikzcd}[column sep=5mm]
	0 & {\Gamma(U,\mathcal{O}_S)} & {\Gamma\big(U,\pi_*\mathcal{O}_E(2e)\big)} & {\Gamma(U,\omega_{E/S}^{\otimes (-2)})} & {H^1(U,\mathcal{O}_S)} \\
	0 & {\Gamma\Big(U,\pi_*\mathcal{O}_E\big((k-1)e\big)\Big)} & {\Gamma\big(U,\pi_*\mathcal{O}_E(ke)\big)} & {\Gamma(U,\omega_{E/S}^{\otimes (-k)})} & {H^1\Big(U,\pi_*\mathcal{O}_E\big((k-1)e\big)\Big)}
	\arrow[from=1-1, to=1-2]
	\arrow[from=1-2, to=1-3]
	\arrow["{p_2}", from=1-3, to=1-4]
	\arrow["0", from=1-4, to=1-5]
	\arrow["{l_2}", curve={height=-20pt}, dashed, from=1-4, to=1-3]
	\arrow[from=2-1, to=2-2]
	\arrow[from=2-2, to=2-3]
	\arrow["{p_k}", from=2-3, to=2-4]
	\arrow["0", from=2-4, to=2-5]
	\arrow["{l_k}", curve={height=-20pt}, dashed, from=2-4, to=2-3]
\end{tikzcd}\]
Since 
$$\Gamma(U,\omega_{E/S}^{\otimes}) \cong \Gamma(U,\pi_* \Omega_{E/S}) \stackrel{\text{def}}{=} \Gamma(\pi^{-1}(U),\Omega_{E/S})$$
is generated by $\omega|_{\pi^{-1}(U)}$ as a free $\mathcal{O}_E(\pi^{-1}(U))=\mathcal{O}_S(U)$-module, we can choose 
\begin{equation*}
\begin{aligned}
  x_0=\;& l_2(\omega^{-2}|_{\pi^{-1}(U)}) \in \Gamma(U,\pi_*\mathcal{O}_E(2e))=\Gamma(\pi^{-1}(U),\mathcal{O}_E(2e) ) \\ 
  y_0=\;& l_3(\omega^{-3}|_{\pi^{-1}(U)}) \in \Gamma(U,\pi_*\mathcal{O}_E(3e))=\Gamma(\pi^{-1}(U),\mathcal{O}_E(3e) ) 
\end{aligned}
\end{equation*}
By a usual dimension argument and Lemma \ref{lem:filstration}, $(x_0,y_0)$ satisfy a Weierstrass equation
$$y^2+a_1xy+a_3y=x^3+a_2x^2+a_4x+a_6.$$
Since $6$ is invertible, we can find $x_0',y_0'$ such that 
$$p_2(x_0')=\omega^{-2}|_{\pi^{-1}(U)} \qquad p_3(y_0')=\omega^{-3}|_{\pi^{-1}(U)}$$
and $(x_0',y_0')$ satisfies the reduced Weierstrass equation
$$y^2=x^3+ax+b \qquad a,b \in \mathcal{O}_S(U).$$
All the sections $x_0',y_0',a,b$ are uniquely determined by these conditions.

\vspace{0.3cm}\noindent\textbf{\underline{Step3}. }
We prove that locally $E$ is defined by this Weierstrass equation.
\begin{proposition}\label{prop:Weiersform}
The sections $x_0',y_0',1$ in $\mathcal{O}_E(3e)|_{\pi^{-1}(U)}$ give a closed embedding 
$$\pi^{-1}(U) \longrightarrow \Proj \mathcal{O}_S(U)[x,y,z] $$
which induces an isomorphism 
$$\psi_U: \pi^{-1}(U) \longrightarrow E_U:= \Proj \mathcal{O}_S(U)[x,y,z]/\left( y^2z-(x^3+axz^2+bz^3) \right).$$
Furthermore, $\omega|_{\pi^{-1}(U)}= \psi_U^*(\omega_U)$, where
$$\omega_U:=  \frac{x\dd z-z\dd x}{2yz}=\frac{y\dd z-z\dd y }{3x^2+az^2} =\frac{x\dd y-y\dd x}{y^2-2axz-3bz^2} \quad\text{ whenever it's defined}$$
is a global generator of $\Omega_{E_U/U}$.
\end{proposition}
\begin{proof}[{Proof of Proposition \ref{prop:Weiersform}}]
The closed embedding can be checked fiberwise(\href{https://math.stackexchange.com/questions/2627476/closed-immersion-on-each-fiber}{2627476}), and the surjectivity of $\psi_U$ can be also checked fiberwise, so $\psi_U$ is an isomorphism.

Notice that $E_U$ is an elliptic curve over $U$, by Lemma \ref{lem:filstration} $\pi_* \mathcal{O}_{E_U}(ne)$ has an canonical filstration, and the symbol $p_2, p_3$ are also used for $E_U$. From the Weierstrass equation we obtain
\begin{equation*}
\begin{aligned}
  \tilde{x_0}:=\;& \frac{x}{z} \in \Gamma(E_U,\mathcal{O}_{E_U}(2e) )= \Gamma(U,\pi_*\mathcal{O}_{E_U}(2e))\\ 
  \tilde{y_0}:=\;& \frac{y}{z} \in \Gamma(E_U,\mathcal{O}_{E_U}(3e) )= \Gamma(U,\pi_*\mathcal{O}_{E_U}(3e))
\end{aligned}
\end{equation*}
where $e: U \longrightarrow E_U$ is given by $[x:y:z]=[0:1:0]$. 

Let $\tilde{\omega}:= \frac{p_2(\tilde{x_0})}{p_3(\tilde{y_0})} \in \Gamma(U,\omega_{E_U/U})$, then $\psi_U^*(\tilde{\omega})=\omega|_{\pi^{-1}(U)}$ by definition, and $\tilde{\omega}=\omega_U$ follows from carefully checking up the definition of $\tilde{\omega}$:
\begin{enumerate}
\item Initially, we have
$$\tilde{\omega}= \frac{p_2(\tilde{x_0})}{p_3(\tilde{y_0})}=\frac{\displaystyle e^*\left(\frac{x}{z} \right)}{\displaystyle e^*\left(\frac{y}{z} \right)}=e^*\left(\frac{x}{y} \right) \in \Gamma(U,e^* \mathcal{O}_{E_U}(-e))$$
\item The isomorphism \footnote{Notice that $d(x/y)$ is not a global differential on $\Omega_{E_U/U}$.}
$$e^* \mathcal{O}_{E_U}(-e)=\mathcal{I}/\mathcal{I}^2 \stackrel{\sim}{\longrightarrow} e^* \Omega_{E_U/U} \qquad \tilde{\omega} \longmapsto e^*\Bigg( d\left(\frac{x}{y}\right) \Bigg) = \frac{xdy-ydx}{y^2}\Big|_e=-dx|_e$$
realizes $\tilde{\omega}$ as a section on $e^*\Omega_{E_U/U}$ over $U$.
\item The isomorphism
$$e^* \Omega_{E_U/U} \cong \omega_{E_U/U} \cong \pi_* \omega_{E_U/U}$$
shows that $\tilde{\omega}|_e=-dx|_e=\omega_U|_e$ when $\tilde{\omega}$ is viewed as a section of $\omega_{E_U/U}$, so $\tilde{\omega}=\omega_U$.
\end{enumerate}
\end{proof}

\vspace{0.3cm}\noindent\textbf{\underline{Step4}. }
Now we glue local informations to get global informations.

Suppose $S=\cup_{i \in I}U_i$, and the Weierstrass equation on $U_i$ is
$$y^2=x^3+a_ix+b_i \qquad a_i,b_i \in \mathcal{O}_S(U_i).$$
By the uniqueness of Weierstrass equation,
$$a_i|_{U_i \cap U_j} = a_j|_{U_i \cap U_j} \qquad b_i|_{U_i \cap U_j} = b_j|_{U_i \cap U_j}$$
so $a_i, b_i$ glue to two global sections $a, b \in \mathcal{O}_S(S)$, and the global Weierstrass equation is
$$y^2=x^3+ax+b \qquad a,b \in \mathcal{O}_S(S).$$
$\Delta$ is invertible since $\Delta|_{U_i}$ is invertible for any $i \in I$.

Moreover, the local isomorphism 
$$\psi_U: \pi^{-1}(U) \longrightarrow \Proj \mathcal{O}_S(U)[x,y,z]/\left( y^2z-(x^3+axz^2+bz^3) \right)$$
glues to the global isomorphism 
$$\psi:E \longrightarrow \Proj \mathcal{O}_S[x,y,z]/\left( y^2z-(x^3+axz^2+bz^3) \right)$$
with $\psi^*(\omega_R)=\omega$. Now it's easy to construct an inverse map $\Psi^{-1}$ and prove that $\Psi$ is an isomorphism.
\end{proof}
To be compatible with the notations in modular form, we rewrite
\begin{equation*}
\begin{aligned}
  R=\;&\mathbb{Z}\!\left[\textstyle \frac{1}{6}\right] \left[a,b, \Delta^{-1} \right] \cong \mathbb{Z}\!\left[\textstyle \frac{1}{6}\right] \left[g_2,g_3, \Delta^{-1} \right]  && a=-\frac{1}{4}g_2, b=-\frac{1}{4}g_3, \Delta=g_3^2-27g_3^2\\
  E_R=\;& \Proj R[x,y,z]/\left( y^2z-(4x^3-g_2xz^2-g_3z^3) \right) && \text{\textcolor{ashgrey}{here $x$ is different}}\\ 
  \omega_R=\;&  \frac{x\dd z-z\dd x}{yz}=\frac{2(y\dd z-z\dd y) }{12x^2-g_2z^2} =\frac{2(x\dd y-y\dd x)}{y^2+2g_2xz+3g_3z^2} &&\text{whenever it's defined.}\\ 
\end{aligned}
\end{equation*}

As an application, we prove that the coarse moduli of functor  $\mathcal{M}\!\left[ \frac{1}{6}\right]:=\mathcal{M}_{1,1}\!\left[ \frac{1}{6}\right]$ is $\mathbb{A}^1_{\mathbb{Z} \!\left[ \frac{1}{6}\right]}$. Recall that $\mathbb{G}_m$ acts on $\widetilde{\mathcal{M}}\!\left[\textstyle \frac{1}{6}\right]$ by
$$R \longrightarrow R \times_{\mathbb{Z}} \mathbb{Z}[t,t^{-1}] \cong R[t,t^{-1}] \qquad g_2\longmapsto t^{-4}g_2 \quad g_3 \longrightarrow t^{-6}g_3,$$
thus $\mathbb{G}_m(S)$ acts on $\widetilde{\mathcal{M}}\!\left[\textstyle \frac{1}{6}\right](S)$ by
$$\mathbb{G}_m(S) \times \widetilde{\mathcal{M}}\!\left[\textstyle \frac{1}{6}\right](S) \longrightarrow \widetilde{\mathcal{M}}\!\left[\textstyle \frac{1}{6}\right](S) \qquad \big(u, (E,\omega) \big) \longmapsto \big(E, u^{\#}(t) \cdot \omega \big).$$
Define
$$j:=1728\frac{g_2^3}{\Delta}=1728\frac{g_2^3}{g_3^2-27g_3^2}\in R^{\mathbb{G}_m},$$
by tedious check we get
$$R^{\mathbb{G}_m} = \mathbb{Z} \!\left[ \textstyle\frac{1}{6}\right][j]$$
which induce the isomorphism 
$$j: \mathbb{G}_m\backslash \widetilde{\mathcal{M}}\!\left[\textstyle \frac{1}{6}\right] \longrightarrow \mathbb{A}^1_{\mathbb{Z} \!\left[ \frac{1}{6}\right]}.$$
\begin{claim}
The scheme $\mathbb{G}_m\backslash \widetilde{\mathcal{M}}\!\left[\textstyle \frac{1}{6}\right] \cong \mathbb{A}^1_{\mathbb{Z} \!\left[ \frac{1}{6}\right]}$ is the course moduli of $\mathcal{M}\!\left[ \frac{1}{6}\right]$.
\begin{figure}[ht]
\centering
% https://q.uiver.app/?q=WzAsNCxbMCwxLCJcXG1hdGhjYWx7TX1cXCFcXGxlZnRbIFxcZnJhY3sxfXs2fVxccmlnaHRdIl0sWzIsMSwiXFxtYXRoYmJ7R31fbVxcYmFja3NsYXNoIFxcd2lkZXRpbGRle1xcbWF0aGNhbHtNfX1cXCFcXGxlZnRbXFx0ZXh0c3R5bGUgXFxmcmFjezF9ezZ9XFxyaWdodF0iXSxbMiwyLCJoX3tYJ30iXSxbMSwwLCJcXHdpZGV0aWxkZXtcXG1hdGhjYWx7TX19XFwhXFxsZWZ0W1xcdGV4dHN0eWxlIFxcZnJhY3sxfXs2fVxccmlnaHRdIl0sWzAsMSwiXFxldGEiXSxbMSwyLCJcXGV4aXN0cyBcXCwhIFxcLGhfe1xcYmV0YX0iLDAseyJjb2xvdXIiOlszNTgsMTAwLDUwXSwic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiZGFzaGVkIn19fSxbMzU4LDEwMCw1MCwxXV0sWzAsMiwiXFxhbHBoYSciLDJdLFszLDAsIlxcdGV4dHtmb3JnZXR9IiwyLHsibGFiZWxfcG9zaXRpb24iOjYwfV0sWzMsMSwiXFx0ZXh0e3F1b3RpZW50fSIsMCx7ImxhYmVsX3Bvc2l0aW9uIjo2MH1dXQ==
\[\begin{tikzcd}
	& {\widetilde{\mathcal{M}}\!\left[\textstyle \frac{1}{6}\right] \makebox[0pt][l]{\textcolor{ashgrey}{$\cong h_{\Spec R}$}}} \\
	{\mathcal{M}\!\left[ \frac{1}{6}\right]} && {\mathbb{G}_m\backslash \widetilde{\mathcal{M}}\!\left[\textstyle \frac{1}{6}\right]\makebox[0pt][l]{\textcolor{ashgrey}{$\cong h_{\mathbb{A}^1_{\mathbb{Z}\left[ 1/6\right]}}$}}} \\
	&& {h_{X'}}
	\arrow["\eta", from=2-1, to=2-3]
	\arrow["{\exists \,! \,h_{\beta}}", color={rgb,255:red,255;green,0;blue,8}, dashed, from=2-3, to=3-3]
	\arrow["{\alpha'}"', from=2-1, to=3-3]
	\arrow["{\text{forget}}"'{pos=0.6}, from=1-2, to=2-1]
	\arrow["{\text{quotient}}"{pos=0.6}, from=1-2, to=2-3]
\end{tikzcd}\]
\caption{verification of coarse moduli}
\label{fig:coarsemoduliofell}
\end{figure}
\end{claim}
\begin{proof}
We check it by the definition of coarse moduli, see Figure \ref{fig:coarsemoduliofell}.
\subsectiondisappear*{\underline{Step1}}
Construct $\eta$. To define \textcolor{ashgrey}{($S \in \Sch_{\mathbb{Z}\left[\frac{1}{6} \right]}$)}
$$\eta(S): \mathcal{M}\!\left[\textstyle \frac{1}{6}\right](S) \longrightarrow \mathbb{G}_m\backslash \widetilde{\mathcal{M}}\!\left[\textstyle \frac{1}{6}\right](S) \cong \Gamma(S,\mathcal{O}_S),$$
we first find differential locally (locally lift to $\widetilde{\mathcal{M}}\!\left[\textstyle \frac{1}{6}\right]$)\footnote{We know that $\Omega_{E/S} \cong \pi^*e^*\Omega_{E/S} \stackrel{loc}{\cong} \pi^*\mathcal{O}_S \cong \mathcal{O}_X$ locally.}, and then take quotient. You need to check:
\begin{itemize}
\item $j$-function doesn't depend on the choice of differential, so $\eta(S)$ is well-defined;
\item $\eta$ is really a functor.
\end{itemize}
\subsectiondisappear*{\underline{Step2}}
We know that GIT quotient is a categorical quotient, so there exists unique $h_{\beta}$ such that 
$$h_{\beta} \circ \text{quotient} = \alpha' \circ \text{forget}.$$
You need to check $\alpha'=h_{\beta} \circ \eta$.
\subsectiondisappear*{\underline{Step3}}
For any closed field $k=\bar{k}$, $\chara k\neq 2,3$, the map
$$\eta(k): \mathcal{M}\!\left[\textstyle \frac{1}{6}\right](k) \longrightarrow \mathbb{G}_m\backslash \widetilde{\mathcal{M}}\!\left[\textstyle \frac{1}{6}\right](k) \cong k$$
is an isomorphism.
\end{proof}
\subsection{Crash course on Abelian variety}
When I was reading some materials about the level structure of elliptic curve, I realised that I'm still not so familiar with some fine structure of elliptic curve, such as $E[n]$. It's usually done as the special case of the Abelian variety\footnote{There are thousands of books talking about elliptic curves, but most of them are unrelavent to us: some restrict themselves to the complex field $\mathbb{C}$, some focus on the applications of cryptography, and some prove every result by the Weierestrass equation, in a very down to earth but ugly way. }. The standard reference is \cite{mumford1974abelian,milne1986abelian}, but we would follow instead \cite{edixhoven2012abelian}\footnote{Be careful that there are a lot of versions in the internet, and the latest verion (as far as I know) is \href{http://van-der-geer.nl/~gerard/AV.pdf}{here}. Unless otherwise specified we cite for the main part of the text rather than the exercises.} since it's much less disgusting to read.

As a lazy guy, I would instead list main tasks in \cite{edixhoven2012abelian}:
\begin{itemize}
\item State the theorem of cubic, and show that 
$$[n]^*\mathcal{L} \cong \mathcal{L}^{\otimes \frac{n(n+1)}{2}} \otimes ([-1]^* \mathcal{L})^{\otimes \frac{n(n-1)}{2}}$$
\item Understand torsion points $X[n]$.
\begin{itemize}
\item Define isogeny(5.3) and isogenous(5.13);
\item Give the canonical factorization of an isogeny(5.8)\footnote{Analog: any field extension can be uniquely written as an inseparable extension with a separable extension.};
\item Examples of isogeny: $[n], F, V$\footnote{$[n]$ is an isogeny when $n \neq 0$; $F$ and $V$ are defined when $\chara k=p>0$.}. Find their relationships(5.19, 5.20);
\item Describe the kernel of isogeny: $X[n], X[F], X[V]$(5.11, 5.22, not completed). 

In char $p$ case, define the relevant notions: $p$-rank, ordinary, supersingular(5.23, 5.25). 

When $p=2,3$, describe the criterian for an elliptic curve to be supersingular(5.26, 5.27). 

When $p=2$, describe the action $\alpha_2$ on $X \subseteq \mathbb{P}_k^2: y^2z+yz^2=x^3$, and show that $X[F] \cong \alpha_2$(5.28). 

For more informations about supersingular curve, see \href{https://en.wikipedia.org/wiki/Supersingular_elliptic_curve}{wiki} and \cite[Proposition 8.2]{saito2014fermat}. 
\end{itemize}
\item Understand Picard group, dual, Weil pairing and Tate modules. I haven't read about it.
\end{itemize} 
\subsection{Level structure}
The second possible extra structure is the level structure.
\subsection{Complex case}
In this subsection, we will show that how the moduli is connected to the modular curve $\mathcal{H}/\SL_2(\mathbb{Z})$.
